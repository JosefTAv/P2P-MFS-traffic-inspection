# Repo environment setup
export P2P_DIR="$(cd "$(dirname ${BASH_SOURCE[0]})" && pwd)" # Other scripts rely on this variable!!

# Export useful stuff for project
export PKG_CONFIG_PATH=$P2P_DIR/server/tools/dpdk-stable/lib/x86_64-linux-gnu/pkgconfig
export LD_LIBRARY_PATH=$P2P_DIR/server/tools/dpdk-stable/lib/x86_64-linux-gnu
export PATH="$P2P_DIR/server/tools/pcimem:$PATH"
export PATH="$P2P_DIR/server/scripts/:$PATH"
export PATH="$P2P_DIR/fpga/scripts/:$PATH"

# PATHs
export XAUTHORITY=$HOME/.Xauthority # X-forwarding
source /tools/Xilinx/Vivado/2023.1/settings64.sh
source /tools/Xilinx/Vitis/2023.1/settings64.sh
export TERM=xterm

# Aliases
alias lsXilinx='sudo lspci -vvvd 10ee:'
alias rescan='sudo echo 1 | sudo tee "/sys/bus/pci/rescan"'
alias virt20='ssh -Y user@192.168.122.157'
alias virt22='ssh -Y user@192.168.122.52'

# Go to directory
alias scripts='cd $P2P_DIR/server/scripts'
alias src_sync='cd $P2P_DIR/server/src_clk_sync'
alias src='cd $P2P_DIR/server/src'
alias dpdk='cd $P2P_DIR/dpdk-stable'
alias fpga='cd $P2P_DIR/fpga'

# Run testpmd
alias testpmd="$P2P_DIR/server/tools/dpdk-stable/build/app/dpdk-testpmd --file-prefix josef -a c1:00.0 -a 81:00.0 -n 3 -- -i"

# Quick actions
alias make_onic='pushd $P2P_DIR/server/src && make clean && make RTE_SDK=`pwd`/../.. RTE_TARGET=build && popd'
alias make_n_run_onic='make_onic && bash run_onicapp.sh'
